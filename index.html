<!DOCTYPE html>
<html>
<head>
    <title>Sols Rng Calculator</title>
    <style>
        :root {
            --bg-dark: #050a0f;
            --card-bg: #0d141f;
            --accent-blue: #00d4ff;
            --soft-blue: #add8e6;
            --glass-bg: rgba(255, 255, 255, 0.03);
            --border-color: rgba(0, 212, 255, 0.2);
        }

        body { 
            font-family: 'Segoe UI', Roboto, sans-serif; 
            padding: 20px; 
            background: radial-gradient(circle at center, #0a192f 0%, #050a0f 100%);
            color: white; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            min-height: 100vh; 
            margin: 0; 
        }

        .calc-card { 
            width: 100%; 
            max-width: 400px; 
            background: var(--card-bg); 
            padding: 30px; 
            border-radius: 20px; 
            border: 1px solid var(--border-color);
            box-shadow: 0 0 30px rgba(0, 212, 255, 0.1), inset 0 0 15px rgba(0, 0, 0, 0.5);
            position: relative;
            overflow: hidden;
        }

        /* Decorative Glow */
        .calc-card::before {
            content: "";
            position: absolute;
            top: -50px;
            right: -50px;
            width: 150px;
            height: 150px;
            background: var(--accent-blue);
            filter: blur(100px);
            opacity: 0.1;
            pointer-events: none;
        }

        h2 { 
            color: var(--soft-blue); 
            text-align: center; 
            text-transform: uppercase; 
            margin-top: 0; 
            margin-bottom: 25px; 
            letter-spacing: 3px;
            font-size: 1.4rem;
            text-shadow: 0 0 10px rgba(173, 216, 230, 0.4);
        }
        
        .mode-switch { 
            display: flex; 
            background: rgba(0, 0, 0, 0.4); 
            border-radius: 12px; 
            padding: 5px; 
            margin-bottom: 25px; 
            border: 1px solid var(--border-color); 
        }

        .mode-btn { 
            flex: 1; 
            padding: 12px; 
            border: none; 
            background: none; 
            color: #557; 
            cursor: pointer; 
            font-weight: bold; 
            font-size: 0.8rem; 
            border-radius: 8px; 
            transition: 0.3s;
        }

        .mode-btn.active { 
            background: var(--accent-blue); 
            color: #000; 
            box-shadow: 0 0 15px rgba(0, 212, 255, 0.4); 
        }

        .section { 
            margin-bottom: 15px; 
            padding: 15px; 
            background: var(--glass-bg); 
            border-radius: 12px; 
            border: 1px solid rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(5px);
        }

        .rarity-container { 
            display: flex; 
            align-items: center; 
            background: rgba(0, 0, 0, 0.3); 
            border: 1px solid var(--border-color); 
            border-radius: 8px; 
            padding: 0 12px; 
            margin: 8px 0; 
            transition: 0.3s;
        }

        .rarity-container:focus-within {
            border-color: var(--accent-blue);
            box-shadow: 0 0 10px rgba(0, 212, 255, 0.2);
        }

        input, select { 
            width: 100%; 
            padding: 12px; 
            margin: 8px 0; 
            border-radius: 8px; 
            border: 1px solid rgba(255, 255, 255, 0.1); 
            background: rgba(0, 0, 0, 0.3); 
            color: white; 
            font-weight: 600; 
            box-sizing: border-box; 
            outline: none;
            transition: 0.3s;
        }

        input:focus, select:focus {
            border-color: var(--accent-blue);
        }

        .prefix { color: var(--accent-blue); font-weight: bold; margin-right: 5px; }
        .rarity-input { border: none !important; margin: 0 !important; background: transparent !important; }
        
        label { font-size: 0.75rem; color: #8aa1b3; display: block; text-transform: uppercase; letter-spacing: 1px; }
        
        .check-row { display: flex; align-items: center; gap: 10px; margin: 8px 0; cursor: pointer; font-size: 0.8rem; color: #8aa1b3; }
        .check-row input { width: auto; margin: 0; accent-color: var(--accent-blue); }

        /* Results Styling */
        .result-box { 
            padding: 20px; 
            border-radius: 12px; 
            text-align: center; 
            margin-top: 10px; 
            transition: 0.5s cubic-bezier(0.4, 0, 0.2, 1); 
            border: 1px solid var(--border-color); 
            background: rgba(0, 212, 255, 0.05); 
        }

        .result-val { font-size: 2.3rem; font-weight: 800; color: var(--accent-blue); margin: 5px 0; }
        .luck-status { font-size: 0.8rem; font-weight: bold; letter-spacing: 2px; }

        /* Tiers */
        .status-idle { border-color: var(--border-color); }
        .status-low { border-color: #ff4d4d; background: rgba(255, 77, 77, 0.05); }
        .status-mid { border-color: #ffcc00; background: rgba(255, 204, 0, 0.05); }
        .status-high { border-color: #00ff88; background: rgba(0, 255, 136, 0.05); }

        .footer { border-top: 1px solid rgba(255, 255, 255, 0.05); margin-top: 25px; padding-top: 15px; display: flex; justify-content: space-between; align-items: center; }
        .discord-link { color: var(--accent-blue); font-size: 0.75rem; text-decoration: none; font-weight: bold; }
        .reset-btn { background: rgba(255, 255, 255, 0.05); color: #ccc; border: 1px solid rgba(255, 255, 255, 0.1); padding: 8px 15px; border-radius: 6px; cursor: pointer; transition: 0.3s; }
        .reset-btn:hover { background: rgba(255, 77, 77, 0.1); color: #ff4d4d; border-color: #ff4d4d; }

    </style>
</head>
<body>

<div class="calc-card">
    <form id="calcForm" onsubmit="return false;">
        <h2>RNG INTERFACE</h2>
        
        <div class="mode-switch">
            <button type="button" id="btnChance" class="mode-btn active" onclick="setMode('chance')">CHANCE</button>
            <button type="button" id="btnTime" class="mode-btn" onclick="setMode('time')">TIME</button>
        </div>

        <div class="section">
            <label>Aura Rarity</label>
            <div class="rarity-container">
                <span class="prefix">1/</span>
                <input type="number" id="rarity" class="rarity-input" value="2500000000">
            </div>

            <div id="rainyContainer" style="display:none; margin-bottom: 10px;">
                <label class="check-row" style="color: var(--accent-blue);">
                    <input type="checkbox" id="isRainy"> Rainy Weather Active
                </label>
            </div>

            <label>Luck Stat</label>
            <input type="number" id="luck" value="30">

            <div style="display: flex; gap: 15px; margin: 10px 0;">
                <label class="check-row"><input type="checkbox" id="vip"> VIP</label>
                <label class="check-row"><input type="checkbox" id="vipPlus"> VIP+</label>
                <label class="check-row"><input type="checkbox" id="event2x"> 2x EVENT</label>
            </div>

            <label>Equipment</label>
            <select id="mult" onchange="checkRainySupport()">
                <option value="1.98">Unfathomable Ruins</option>
                <option value="1.8">Darkshader</option>
                <option value="pole">Pole Light Core</option>
                <option value="grav">Gravitational Device</option>
                <option value="1.3">Flesh Device</option>
                <option value="jackpot">Jackpot Gauntlet</option>
                <option value="gemstone">Gemstone Gauntlet</option>
                <option value="xmas" class="event-item" style="display:none;">X-Mas Champion</option>
                <option value="present" class="event-item" style="display:none;">Present Giver</option>
                <option value="blessed" class="event-item" style="display:none;">Blessed Tide</option>
                <option value="tide" class="event-item" style="display:none;">Tide Gauntlet</option>
                <option value="1.35" class="event-item" style="display:none;">Ominous Coffin</option>
            </select>
            
            <label class="check-row" style="font-size: 0.7rem;">
                <input type="checkbox" id="showEvent" onchange="toggleEventGear()"> Enable Legacy Gear
            </label>

            <label>Roll Cycle (Rolls / Sec)</label>
            <div style="display:flex; gap:10px;">
                <input type="number" id="speedR" value="20">
                <input type="number" id="speedS" value="10">
            </div>
        </div>

        <div id="sectionChance" class="section">
            <label>Roll Duration (Days)</label>
            <input type="number" id="days" placeholder="Enter days...">
            <div class="result-box" id="chanceBox">
                <label style="font-size: 0.65rem; color: var(--soft-blue);">Predicted Probability</label>
                <div class="result-val" id="outputChance">0.00%</div>
                <span class="luck-status" id="chanceLabel">STANDBY</span>
                <span class="stat-subtext" id="totalRolls" style="font-size: 0.65rem; color: #557; display: block; margin-top: 5px;">0 rolls</span>
            </div>
        </div>

        <div id="sectionTime" class="section" style="display:none;">
            <label>Target Threshold (%)</label>
            <input type="number" id="targetP" placeholder="e.g. 50">
            <div class="result-box" id="timeBox">
                <label style="font-size: 0.65rem; color: var(--soft-blue);">Required AFK Time</label>
                <div class="result-val" id="outputTime">-- Days</div>
                <span class="luck-status" id="timeLabel">CALCULATING</span>
                <span class="stat-subtext" id="rollsNeeded" style="font-size: 0.65rem; color: #557; display: block; margin-top: 5px;">0 rolls</span>
            </div>
        </div>

        <div class="footer">
            <a href="https://discord.gg/yTreH64JBC" class="discord-link" target="_blank">COMMUNITY DISCORD</a>
            <button type="button" class="reset-btn" onclick="fullReset()">RESET</button>
        </div>
    </form>
</div>

<script>
    // [The JavaScript logic remains identical to your previous fixed version]
    // Keeping logic here so it's a complete, copy-pasteable file.
    let currentMode = 'chance';
    let calcTimeout;

    function debouncedCalculate() {
        clearTimeout(calcTimeout);
        calcTimeout = setTimeout(calculate, 100);
    }

    function setMode(mode) {
        currentMode = mode;
        document.getElementById('sectionChance').style.display = (mode === 'chance') ? 'block' : 'none';
        document.getElementById('sectionTime').style.display = (mode === 'time') ? 'block' : 'none';
        document.getElementById('btnChance').classList.toggle('active', mode === 'chance');
        document.getElementById('btnTime').classList.toggle('active', mode === 'time');
        calculate();
    }

    function fullReset() {
        document.getElementById('calcForm').reset();
        document.getElementById('showEvent').checked = false;
        toggleEventGear();
        checkRainySupport();
        setMode('chance');
    }

    function toggleEventGear() {
        const isChecked = document.getElementById('showEvent').checked;
        const items = document.getElementsByClassName('event-item');
        const gloveSelect = document.getElementById('mult');
        const currentOption = gloveSelect.options[gloveSelect.selectedIndex];
        const isEventOption = currentOption.classList.contains('event-item');
        for (let item of items) { item.style.display = isChecked ? "block" : "none"; }
        if (!isChecked && isEventOption) { gloveSelect.value = "1.98"; }
        checkRainySupport();
        calculate();
    }

    function checkRainySupport() {
        const glove = document.getElementById('mult').value;
        const container = document.getElementById('rainyContainer');
        container.style.display = (glove === "tide" || glove === "blessed") ? "block" : "none";
        calculate();
    }

    function updateVisuals(id, probability, isTimeMode = false) {
        const box = document.getElementById(id + 'Box');
        const label = document.getElementById(id + 'Label');
        const valText = document.getElementById('output' + id);
        box.classList.remove('status-low', 'status-mid', 'status-high', 'status-idle');
        if (probability <= 0) {
            box.classList.add('status-idle');
            label.innerText = isTimeMode ? "STANDBY" : "IDLE";
            label.style.color = "var(--soft-blue)";
            valText.style.color = "var(--accent-blue)";
        } else if (probability < 0.10) {
            box.classList.add('status-low');
            label.innerText = "EXTREME LONGSHOT";
            label.style.color = "#ff4d4d";
            valText.style.color = "#ff4d4d";
        } else if (probability < 0.50) {
            box.classList.add('status-mid');
            label.innerText = "FAIR ODDS";
            label.style.color = "#ffcc00";
            valText.style.color = "#ffcc00";
        } else {
            box.classList.add('status-high');
            label.innerText = "SAFE BET";
            label.style.color = "#00ff88";
            valText.style.color = "#00ff88";
        }
    }

    function calculate() {
        const R_base = parseFloat(document.getElementById('rarity').value) || 1;
        const displayLuck = parseFloat(document.getElementById('luck').value) || 0;
        const glove = document.getElementById('mult').value;
        const isRainy = document.getElementById('isRainy').checked;
        let finalMult = 1;
        const v1 = document.getElementById('vip').checked;
        const v2 = document.getElementById('vipPlus').checked;
        if (v1 && v2) finalMult = 1.3; else if (v1 || v2) finalMult = 1.2;
        if (document.getElementById('event2x').checked) finalMult *= 2;
        let rawLuck = displayLuck / finalMult;
        let pAvg;
        let speedMult = 1;
        const rainyDiv = isRainy ? 4 : 1;
        if (glove === "blessed") {
            pAvg = (5 * (rawLuck / R_base) + 1 * ((rawLuck * 3) / (R_base / rainyDiv))) / 6;
            pAvg *= finalMult; 
        } else if (glove === "tide") {
            pAvg = (9 * ((rawLuck + 0.5) / R_base) + 1 * (((rawLuck + 0.5) * 2) / (R_base / rainyDiv))) / 10;
            pAvg *= finalMult;
        } else {
            let L_add = 0, M_glove = 1;
            if (glove === "pole") { L_add = 5; M_glove = 1.1; speedMult = 34 / 30; }
            else if (glove === "grav") { M_glove = 1.5; }
            else if (glove === "jackpot") { L_add = 0.77; }
            else if (glove === "gemstone") { L_add = 0.075; }
            else if (glove === "xmas") { M_glove = 1.5; }
            else if (glove === "present") { M_glove = 1.36; }
            else if (glove === "1.35") { M_glove = 1.35; } 
            else { M_glove = parseFloat(glove) || 1; }
            pAvg = ((rawLuck + L_add) * M_glove * finalMult) / R_base;
        }
        const rInput = parseFloat(document.getElementById('speedR').value) || 1;
        const sInput = parseFloat(document.getElementById('speedS').value) || 1;
        const rollsPerDay = (rInput / sInput) * 86400 * speedMult;
        const dInput = document.getElementById('days').value;
        const d = parseFloat(dInput) || 0;
        const totalRolls = rollsPerDay * d;
        const P = (d > 0 && pAvg > 0) ? 1 - Math.pow((1 - pAvg), totalRolls) : 0;
        let displayChance = (P >= 0.9999999) ? "99.99%+" : (P * 100).toFixed(2) + "%";
        document.getElementById('outputChance').innerText = displayChance;
        document.getElementById('totalRolls').innerText = Math.floor(totalRolls).toLocaleString() + " rolls";
        if (currentMode === 'chance') updateVisuals('chance', (dInput === "" ? 0 : P), false);
        const targetPInput = document.getElementById('targetP').value;
        const targetP = (parseFloat(targetPInput) || 0) / 100;
        if (targetP > 0 && targetP < 1 && pAvg > 0) {
            const n_needed = Math.log(1 - targetP) / Math.log(1 - pAvg);
            const neededDays = n_needed / rollsPerDay;
            document.getElementById('outputTime').innerText = neededDays > 1000 ? neededDays.toExponential(2) + " Days" : neededDays.toFixed(2) + " Days";
            document.getElementById('rollsNeeded').innerText = Math.ceil(n_needed).toLocaleString() + " rolls needed";
            if (currentMode === 'time') updateVisuals('time', targetP, true);
        } else {
            document.getElementById('outputTime').innerText = "-- Days";
            document.getElementById('rollsNeeded').innerText = "0 rolls needed";
            if (currentMode === 'time') updateVisuals('time', 0, true);
        }
    }

    document.querySelectorAll('input, select').forEach(el => {
        el.addEventListener('input', debouncedCalculate);
    });
    calculate();
</script>

</body>
</html>
